/* LegacyMode */
(()=>{var ut=Object.defineProperty,se=Object.defineProperties,ae=Object.getOwnPropertyDescriptor,le=Object.getOwnPropertyDescriptors;var xt=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable;var gt=(o,t,e)=>t in o?ut(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,z=(o,t)=>{for(var e in t||(t={}))ce.call(t,e)&&gt(o,e,t[e]);if(xt)for(var e of xt(t))ge.call(t,e)&&gt(o,e,t[e]);return o},Z=(o,t)=>se(o,le(t)),i=(o,t)=>ut(o,"name",{value:t,configurable:!0});var c=(o,t,e,n)=>{for(var r=n>1?void 0:n?ae(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=(n?a(t,e,r):a(r))||r);return n&&r&&ut(t,e,r),r};var d=(o,t,e)=>(gt(o,typeof t!="symbol"?t+"":t,e),e);var p=(o,t,e)=>new Promise((n,r)=>{var s=u=>{try{g(e.next(u))}catch(f){r(f)}},a=u=>{try{g(e.throw(u))}catch(f){r(f)}},g=u=>u.done?n(u.value):Promise.resolve(u.value).then(s,a);g((e=e.apply(o,t)).next())});var l={modules:["SignalsIds","SignalsBsc","SignalsVlp","SignalsTvp","SignalsAbs","LegacyLayer","SignalsAutoInsertion","GptMeasurement","TimeConfig"],configs:{RFYxMDExNDU1:[0,1,2,3,4,5,6],"RFY2NzM2NzI=":[0,1,2,3,4,5,6],"RFY5MDI5MjM=":[0,1,2,3,5,6],"RFY3NTc3MzA=":[0,1,2,3,5,6],"RFY0NjQwNDE=":[0,1,2,4,5,6],"RFY5Mzc0NzU=":[0,1,5,6],RFYxMDA3NTE4:[0,1,5,6],"RFY5NDA4NDg=":[0,1,2,3,5,6],"RFY5NjI3ODA=":[0,1,5,6],"RFY4NTk0NDQ=":[0,1,5,6],"RFYzMTIyNjI=":[0,1,5,6],"RFY2ODkyNDk=":[0,1,2,3,5,6],"RFYzNzU5MzU=":[0,1,2,5,6],"RFY0NjUxNTc=":[0,1,2,5,6],"RFY5NzQ3MzE=":[0,1,2,3,5],"RFY4NjQ3ODc=":[4,5,6],"RFY4MzIzNTM=":[0,1,5,6],"RFY4Mzc3NTE=":[0,1,5,6],"RFY2NzI1MjE=":[0,1,2,3,5,6],RFYxMDAxNjU0:[0,1,2,3,4,5,6],"RFY0NjQwMzM=":[0,1,2,5,6],"RFY4Njg2MDI=":[0,1,5,6],"RFY5NjM2Mzg=":[0,1,5,6],"RFY5NDU5ODg=":[0,1,2,3,4,5,6],"RFY2NDcwODg=":[0,1,2,3,5,6],"RFY4OTI0NzQ=":[0,1,5,6],"RFY4MDkxOTk=":[0,1,2,3,5,6],"RFY4OTMwNTY=":[0,1,2,3,5],RFYxMDEyNjAw:[0,1,2,3,4,5,6],"RFY5Nzg2NjI=":[6],"RFY2ODQzNDg=":[0,1,2,3,4,5,6],"RFY5MDc4OTY=":[0,1,5,6],"RFY5NzU2NzU=":[0,1,5,6],"RFY3MTA4Nzg=":[0,1,2,3,5,6],"RFY3Nzc1NzY=":[0,1,2,3,5,6],"RFY2NjkzNjE=":[0,1,2,3,5,6],"RFY5OTY4NzY=":[0,1,5,6],"RFY5OTY5MjE=":[0,1,5,6],RFYxMDEzMTQ1:[0,1,5,6],RFYxMDA3NTMz:[0,1,5,6],"RFY1ODc0MTQ=":[0,1,2,3,5,6],"MTc0OTI1Mjg=":[0,1,2,5,6],"RFYzMTIyNjc=":[0,1,5,6],"RFY5NDExNDc=":[0,1,5,6],"RFY5ODQwMzg=":[0,1,5,6],"RFY5MjM0MTM=":[4,5,6],"RFY5NDQwMTI=":[0,1,5,6],"RFYzMTIwNDg=":[0,1,2,5,6],"RFYzMTIyNzc=":[0,1,5,6],"RFY4Njg2NzM=":[0,1,5,6],"RFY5MTcyMzI=":[0,1,5,6],"RFYzMTIyNzI=":[0,1,5,6],"RFY3MzQzNDI=":[0,1,2,3,4,5,6],"RFYxMTExMTE=":[0,1,2,3,5,6],"RFY5NzI5MzU=":[6],"RFY0MjQ5NDA=":[0,1,2,5,6],"RFY5NTU1NTQ=":[0,1,5,6],RFYxMDA3NTI3:[0,1,5,6],"RFY5NDExMTc=":[0,1,5,6],"RFYzMTI3OTI=":[0,1,5,6],"RFY3MTg2ODU=":[0,5],"RFY5NDIxOTY=":[0,1,2,3,4,5,6],"RFYzNzQxNTg=":[0,1,2,5,6],"RFY5NzQ3MzA=":[0,1,2,3,5],"RFY5MTA2Mzg=":[0,1,2,3,5],"RFY3OTc2ODY=":[0,1,2,3,5,6],"RFY5NzQ3MzI=":[],RFYxMDA3NTky:[0,1,5,6],"RFY0NjQwMjE=":[0,1,2,3,5,6],"RFY4NDY4Mjc=":[0,1,2,3,5],"RFY5NDM5NzQ=":[0,1,5,6],"RFY3NTk1MjA=":[0,1,2,3,5,6,7,8],"RFY4NjkyMzY=":[0,1,5,6],"RFY5MDc5MzU=":[0,1,5,6],"RFY5NjQzMTQ=":[0,1,5,6],RFYxMDEwNzI4:[],"RFY2NTE3NDQ=":[0,1,2,3,4,5,6],"RFY4MDU2MDE=":[0,2,3,5],"RFY3OTI4NTU=":[0,1,2,3,4,5,6],"RFY4MzIzNDY=":[0,1,5,6],"RFY4NjYwMjU=":[0,1,2,3,5,6],"RFY5NDMzOTk=":[0,1,2,3,4,5,6],RFYxMDE0MzQ0:[0,1,2,3,4,5,6],"RFY3NDg3MjI=":[0,1,5,6],"RFY2NzUwMzg=":[0,1,2,3,5,6],"RFYzMTIyNjE=":[0,1,5,6],"RFY3Nzc4ODU=":[0,1,2,3,5,6],"RFY4NDQ0Njg=":[0,1,2,3,5,6],"RFY4OTI0Nzk=":[0,1,5,6],"RFY4Mjc5Njk=":[0,1,5,6],"RFY4OTY3MTQ=":[0,1,2,3,4,5,6],"RFY5ODk2NzI=":[4,5,6],"RFY4MjE5MTg=":[0,1,2,3,5,6],"RFY5NzU3MDM=":[0,1,5,6]}};var Ct={getVisitTargeting:()=>p(void 0,null,function*(){return{}}),getSlotTargeting:o=>p(void 0,null,function*(){return{}})};var _t=z({queueAdRequest:o=>{var t;try{(t=o.callback)==null||t.call(o),o.callback=null}catch(e){}}},Ct);var tt=class{constructor(t,e){d(this,"window");d(this,"dvtag");d(this,"modules",new Map);var n;this.window=e,this.window.dvtag=(n=this.window.dvtag)!=null?n:{},this.dvtag=this.window.dvtag,this.dvtag._core=this;for(let[r,s]of Object.entries(_t))this.dvtag[r]=s;for(let r of t)this.createModule(r);for(let r of this.modules.values())this.applyModuleDecoration(r);for(let r of this.modules.values())this.applyPluginDecoration(r);for(let r of this.modules.values())this.applyApiDecoration(r);for(let r of this.modules.values())this.applyExecuteDecoration(r)}get(t){return this.getModule(t).gateway}getByName(t){let e=[...this.modules.keys()].find(n=>n.name===t);return e!=null?this.get(e):null}getModule(t){let e=this.modules.get(t);if(e==null)throw new Error(`module not in core: ${t.name}`);return e}createModule(t){if(t.prototype.moduleConfig==null)throw new Error(`not a module: ${t.name}`);let e=new t;e.core=this,e.gateway={module:e},this.modules.set(t,e)}applyModuleDecoration(t){let e=t.constructor.prototype.moduleConfig;for(let{method:n}of e){let r=t[n].bind(t),s=i((...a)=>{var y,h,T,P,x,V;let g,u=(T=(h=(y=this.dvtag._hooks)==null?void 0:y.interceptModule)==null?void 0:h[t.constructor.name])==null?void 0:T[n];u==null?g=r(...a):g=u(...a);let f=(V=(x=(P=this.dvtag._hooks)==null?void 0:P.inspectModule)==null?void 0:x[t.constructor.name])==null?void 0:V[n];return f!=null&&f(a,g),g},"gatedMethod");t.gateway[n]=s}}applyPluginDecoration(t){var n;let e=(n=t.constructor.prototype.pluginConfig)!=null?n:[];for(let{PluggableClass:r,category:s,method:a}of e)this.getModule(r).plugins[s].push(t.gateway[a])}applyApiDecoration(t){var n;let e=(n=t.constructor.prototype.apiConfig)!=null?n:[];for(let{api:r,method:s}of e)Object.defineProperty(this.dvtag,r,{value:t.gateway[s],writable:!1})}applyExecuteDecoration(t){var n;let e=(n=t.constructor.prototype.executeConfig)!=null?n:[];for(let{method:r}of e)t.gateway[r]()}};i(tt,"Core");var dt=[],pt=dt;var m=i(o=>{let t=o.prototype,e=Object.getOwnPropertyNames(t).filter(n=>{var r;return n!=="constructor"&&((r=Object.getOwnPropertyDescriptor(t,n))==null?void 0:r.value)instanceof Function});t.moduleConfig=e.map(n=>({method:n})),dt.push(o)},"moduleClass"),D=i((o,t)=>{var e;o.executeConfig=(e=o.executeConfig)!=null?e:[],o.executeConfig.push({method:t})},"executeMethod"),I=i((o,t)=>(e,n)=>{var r;e.pluginConfig=(r=e.pluginConfig)!=null?r:[],e.pluginConfig.push({PluggableClass:o,category:t,method:n})},"pluginMethod"),mt=i(o=>(t,e)=>{var n;t.apiConfig=(n=t.apiConfig)!=null?n:[],t.apiConfig.push({api:o,method:e})},"apiMethod");var F=i((o,...t)=>{try{return o(...t)}catch(e){return null}},"tryFunction"),ft=i((o,...t)=>p(void 0,null,function*(){try{return yield o(...t)}catch(e){return null}}),"tryFunctionAsync"),S=i((o,...t)=>o.map(e=>F(e,...t)),"tryFunctions");var rt=class{constructor(){d(this,"pending",[]);d(this,"flushing",!1)}push(t){this.pending.push(t),this.flush()}flush(){return p(this,null,function*(){var e;if(this.flushing)return;this.flushing=!0;let t=this.pending.shift();for(;t!=null;){try{yield t.promise}catch(n){}try{(e=t.callback)==null||e.call(t)}catch(n){}t=this.pending.shift()}this.flushing=!1})}};i(rt,"AsyncQueue");var U=class{constructor(){d(this,"plugins",{onAdRequestQueued:[]});d(this,"queue",new rt);d(this,"adRequests",[])}onAdRequestQueued(t){return p(this,null,function*(){if(S(this.plugins.onAdRequestQueued),t==null)return;let e={status:0,timeoutValue:t.timeout,timeoutStarted:t.timestamp,delayStarted:new Date().getTime()};this.adRequests.push(e);let n=t.callback;n==null?e.status=1:t.callback=()=>{e.status=2,e.released=new Date().getTime(),t.callback=null,n()};let r=i(()=>{e.delayEnded=new Date().getTime(),t.callback!=null&&(t.callback=null,e.status=3,e.released=new Date().getTime(),n==null||n())},"onAsyncOperationsCompleted");this.queue.push({callback:r})})}delayAdRequests(t){this.queue.push({promise:t})}getAdRequestStatusses(){return this.adRequests}};i(U,"DelayAdRequests"),c([mt("queueAdRequest")],U.prototype,"onAdRequestQueued",1),U=c([m],U);var Mt=i(o=>{var t,e;return o.googletag=(t=o.googletag)!=null?t:{},o.googletag.cmd=(e=o.googletag.cmd)!=null?e:[],o.googletag},"getGoogletag");var A=class{onPubAdsReady(t){return p(this,null,function*(){var r;let e=Mt(this.core.window),n=(r=e.pubads)==null?void 0:r.call(e);return n!=null?t(n):new Promise(s=>{e.cmd.push(()=>{s(t(e.pubads()))})})})}};i(A,"GoogletagPubads"),A=c([m],A);var _=class{constructor(){d(this,"plugins",{slotRequested:[],slotRenderEnded:[],impressionViewable:[],slotOnload:[],slotVisibilityChanged:[],slotResponseReceived:[],rewardedSlotGranted:[],rewardedSlotClosed:[],rewardedSlotReady:[]});d(this,"isEventsAttached",!1)}attachEvents(){return p(this,null,function*(){this.isEventsAttached||(this.isEventsAttached=!0,yield this.core.get(A).onPubAdsReady(t=>{for(let[e,n]of Object.entries(this.plugins))n.length>0&&t.addEventListener(e,r=>S(n,r))}))})}};i(_,"GoogletagEvents"),c([D],_.prototype,"attachEvents",1),_=c([m],_);var at,de=new Uint8Array(16);function St(){if(!at&&(at=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!at))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return at(de)}i(St,"rng");var v=[];for(let o=0;o<256;++o)v.push((o+256).toString(16).slice(1));function kt(o,t=0){return(v[o[t+0]]+v[o[t+1]]+v[o[t+2]]+v[o[t+3]]+"-"+v[o[t+4]]+v[o[t+5]]+"-"+v[o[t+6]]+v[o[t+7]]+"-"+v[o[t+8]]+v[o[t+9]]+"-"+v[o[t+10]]+v[o[t+11]]+v[o[t+12]]+v[o[t+13]]+v[o[t+14]]+v[o[t+15]]).toLowerCase()}i(kt,"unsafeStringify");var pe=typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ht={randomUUID:pe};function me(o,t,e){if(ht.randomUUID&&!t&&!o)return ht.randomUUID();o=o||{};let n=o.random||(o.rng||St)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){e=e||0;for(let r=0;r<16;++r)t[e+r]=n[r];return t}return kt(n)}i(me,"v4");var Tt=me;var j=i(()=>Tt(),"uuid");var fe=i(o=>typeof o=="string","sizeIsLabel"),Se=i(o=>typeof o=="object"&&typeof o.width=="number"&&typeof o.height=="number","sizeIsObject"),he=i(o=>{var n;let t;try{t=(n=o.getSizes)==null?void 0:n.call(o)}catch(r){}if(!(t instanceof Array))return[];let e=[];for(let r of t)fe(r)?e.push({label:r}):Se(r)&&e.push({width:r.width,height:r.height});return e},"safelyGetSizes"),lt=i(o=>{let t=o.getAdUnitPath(),e=o.getSlotElementId(),n=he(o);return{unitId:t,elementId:e,sizes:n,uuid:j()}},"parseSlot");var Ut=i((o,t)=>{let n=t.slot.getResponseInformation();if(!n)throw new Error("Expected getResponseInformation to return non-null for this event");return Z(z({},o),{advertiserId:n==null?void 0:n.advertiserId,campaignId:n==null?void 0:n.campaignId,creativeId:n==null?void 0:n.creativeId,creativeTemplateId:n==null?void 0:n.creativeTemplateId,lineItemId:n==null?void 0:n.lineItemId})},"parseFilledSlotFromEvent"),Lt=i((o,t)=>Z(z({},o),{advertiserId:t.advertiserId,campaignId:t.campaignId,creativeId:t.creativeId,creativeTemplateId:t.creativeTemplateId,lineItemId:t.lineItemId,isBackfill:t.isBackfill,isEmpty:t.isEmpty,slotContentChanged:t.slotContentChanged,renderedSize:Te(t.size)}),"parseRenderedSlotFromEvent"),Te=i(o=>o==null?null:Array.isArray(o)?`${o[0]}x${o[1]}`:o,"parseSize");var w=class{constructor(){d(this,"plugins",{newSlotDetected:[],adRequestedForSlot:[],slotResponseReceived:[],slotRenderEnded:[],slotOnLoad:[]});d(this,"_knownSlots",{})}maybeDiscoverNewSlot(t){let e=this._knownSlots[t.getSlotElementId()];return e==null&&(e=lt(t),this._knownSlots[e.elementId]=e,S(this.plugins.newSlotDetected,e)),e}scanForNewSlots(t){t!=null&&t.getSlots().forEach(e=>this.maybeDiscoverNewSlot(e))}getSlots(){return p(this,null,function*(){return this.core.get(A).onPubAdsReady(t=>(this.scanForNewSlots(t),Object.values(this._knownSlots)))})}onSlotRequested(t){let e=this.maybeDiscoverNewSlot(t.slot);S(this.plugins.adRequestedForSlot,e)}onSlotResponseReceived(t){let e=this.maybeDiscoverNewSlot(t.slot),n=Ut(e,t);S(this.plugins.slotResponseReceived,n)}onSlotRenderEnded(t){let e=this.maybeDiscoverNewSlot(t.slot),n=Lt(e,t);S(this.plugins.slotRenderEnded,n)}onSlotOnLoad(t){let e=this.maybeDiscoverNewSlot(t.slot);S(this.plugins.slotOnLoad,e)}};i(w,"GoogletagSlots"),c([I(_,"slotRequested")],w.prototype,"onSlotRequested",1),c([I(_,"slotResponseReceived")],w.prototype,"onSlotResponseReceived",1),c([I(_,"slotRenderEnded")],w.prototype,"onSlotRenderEnded",1),c([I(_,"slotOnload")],w.prototype,"onSlotOnLoad",1),w=c([m],w);var O=class{constructor(){d(this,"plugins",{log:[],info:[],debug:[],warn:[],error:[]})}log(...t){S(this.plugins.log,...t)}info(...t){S(this.plugins.info,...t)}debug(...t){S(this.plugins.debug,...t)}warn(...t){S(this.plugins.warn,...t)}error(...t){S(this.plugins.error,...t)}};i(O,"Logging"),O=c([m],O);var yt=i((o,t,e)=>{let n=o.getTargeting(t),r=[...new Set([...n,...e])];o.setTargeting(t,r)},"addTargeting"),ye=i((o,t,e)=>{let n=[...new Set(e)];o.setTargeting(t,n)},"setTargeting"),Pt=i((o,t,e)=>{yt(o,t,e);for(let n of o.getSlots())n.getTargetingKeys().includes(t)&&yt(n,t,e)},"addGlobalTargetingForKey"),Ft=i((o,t,e,n)=>{t.getTargetingKeys().includes(e)||(n=[...n,...o.getTargeting(e)]),yt(t,e,n)},"addSlotTargetingForKey"),Ot=i((o,t,e,n)=>{n=[...n,...o.getTargeting(e)],ye(t,e,n)},"setSlotTargetingForKey");var C=class{addGlobalTargeting(t){return p(this,null,function*(){yield this.core.get(A).onPubAdsReady(e=>{for(let[n,r]of Object.entries(t))Pt(e,n,r)})})}setGlobalTargeting(t){return p(this,null,function*(){yield this.core.get(A).onPubAdsReady(e=>{for(let[n,r]of Object.entries(t))e.setTargeting(n,r)})})}addSlotTargeting(t,e){return p(this,null,function*(){yield this.core.get(A).onPubAdsReady(n=>{let r=n.getSlots().find(s=>s.getSlotElementId()===t);if(r==null){this.core.get(O).error(`Adding targeting to slot that is not known in GPT: ${t}`);return}for(let[s,a]of Object.entries(e))Ft(n,r,s,a)})})}setSlotTargeting(t,e){return p(this,null,function*(){yield this.core.get(A).onPubAdsReady(n=>{let r=n.getSlots().find(s=>s.getSlotElementId()===t);if(r==null){this.core.get(O).error(`Setting targeting for slot that is not known in GPT: ${t}`);return}for(let[s,a]of Object.entries(e))Ot(n,r,s,a)})})}getSlotTargeting(t,e){return p(this,null,function*(){return this.core.get(A).onPubAdsReady(n=>{let r=n.getSlots().find(s=>s.getSlotElementId()===t);return r==null?(this.core.get(O).warn(`Getting targeting from slot that is not known in GPT: ${t}`),null):(e=e!=null?e:r.getTargetingKeys(),e.reduce((s,a)=>{let g=r.getTargeting(a);return s[a]=g.length>0?g:n.getTargeting(a),s},{}))})})}};i(C,"GoogletagTargeting"),C=c([m],C);var R=class{constructor(){d(this,"plugins",{newSlotDetected:[],adRequestedForSlot:[],slotResponseReceived:[],slotRenderEnded:[],slotOnLoad:[]})}onNewSlotDetected(t){S(this.plugins.newSlotDetected,t)}onAdRequestedForSlot(t){S(this.plugins.adRequestedForSlot,t)}onSlotResponseReceived(t){S(this.plugins.slotResponseReceived,t)}onSlotRenderEnded(t){S(this.plugins.slotRenderEnded,t)}onSlotOnLoad(t){S(this.plugins.slotOnLoad,t)}getSlots(){return p(this,null,function*(){return this.core.get(w).getSlots()})}addGlobalTargeting(t){return p(this,null,function*(){return this.core.get(C).addGlobalTargeting(t)})}setGlobalTargeting(t){return p(this,null,function*(){return this.core.get(C).setGlobalTargeting(t)})}addSlotTargeting(t,e){return p(this,null,function*(){return this.core.get(C).addSlotTargeting(t,e)})}setSlotTargeting(t,e){return p(this,null,function*(){return this.core.get(C).setSlotTargeting(t,e)})}getSlotTargeting(t,e){return p(this,null,function*(){return e==null?this.core.get(C).getSlotTargeting(t):this.core.get(C).getSlotTargeting(t,e)})}};i(R,"Googletag"),c([I(w,"newSlotDetected")],R.prototype,"onNewSlotDetected",1),c([I(w,"adRequestedForSlot")],R.prototype,"onAdRequestedForSlot",1),c([I(w,"slotResponseReceived")],R.prototype,"onSlotResponseReceived",1),c([I(w,"slotRenderEnded")],R.prototype,"onSlotRenderEnded",1),c([I(w,"slotOnLoad")],R.prototype,"onSlotOnLoad",1),c([D,I(U,"onAdRequestQueued")],R.prototype,"getSlots",1),R=c([m],R);var ct=["BSC","ABS"],Nt=["IDS"],Q=["VLP","TVP"],vt=[...ct,...Nt,...Q],Rt=i(o=>vt.includes(o.toUpperCase()),"isSignal"),et=i(o=>Q.includes(o.toUpperCase()),"isSlotSignal"),qt=i(o=>Nt.includes(o.toUpperCase()),"isUserSignal"),Gt=i(o=>ct.includes(o.toUpperCase()),"isPageSignal"),wt=i(o=>o.map(t=>t.toUpperCase()).filter(Rt),"asSignals");var L=class{constructor(){d(this,"size",-1)}initialize(){return p(this,null,function*(){yield Promise.resolve(),this.flushBuffer()})}flushBuffer(){if(this.size!==-1)return;let t=this.core.dvtag.cmd instanceof Array?this.core.dvtag.cmd:[];this.core.dvtag.cmd=t,t.push=(...e)=>(this.flushCommands(e),this.size+=e.length,this.size),this.flushCommands(t),this.size=t.length,t.length=0}flushCommands(t){let e=this.core.get(U);for(let n of t)e.delayAdRequests(ft(n))}push(...t){var e;this.core.dvtag.cmd=(e=this.core.dvtag.cmd)!=null?e:[],this.core.dvtag.cmd.push(...t)}};i(L,"CommandBuffer"),c([D],L.prototype,"initialize",1),L=c([m],L);var N=class{constructor(){d(this,"pq",null)}getPq(){return this.pq==null&&(this.pq=this.initialize()),this.pq}getPts(){return this.getPq().PTS}setApi(t){let e=this.getPq();e!=null&&(e.init=()=>{},e.loadSignals=t.loadSignals,e.loadSignalsForSlots=t.loadSignalsForSlots,e.getTargeting=t.getTargeting)}initialize(){var r,s;this.core.window.PQ=(r=this.core.window.PQ)!=null?r:{};let t=this.core.window.PQ;if(t.loaded)return{cmd:[],PTS:{}};t.loaded=!0,t.PTS=(s=t.PTS)!=null?s:{};let e=this.core.get(L),n=t.cmd;return t.cmd={push:a=>e.push(a)},Array.isArray(n)&&e.push(...n),t}};i(N,"LegacyPq"),N=c([m],N);var ve=[[/((\?)|&)(?:amp_lite|fr=operanews)/g,"$2"],[/(^https?:\/\/)(www\.)/g,"$1"],[/(((\?)|&|%3F|%26|;)(?:utm_campaign|utm_source|utm_content|utm_term|utm_viral|utm_medium|utm_identifier|utm_key|fb_source|referrer|referer|ref|rand|rnd|randid|\.?rand|\.?partner|cb|count|adid|session|sessionid|session_redirect|param\d|userinfo|uid|refresh|ocid|ncid|clickenc|fbclid|amp_js_v|amp_gsa|ns_source|ns_campaign|ns_mchanel|ns_mchannel|ns_linkname|ns_fee|src|ex_cid|usqp|source|xid|trkid|utm_social-type|mbid|utm_brand|__twitter_impression|utm_referrer|CMP|cmp|_cmp|cq_cmp)=[^&]*)/g,"$3"],[/[/.]amp(?:\/[?&]*)?$/g,""],[/((\?)|&)(?:outputType|isFollow|suppressMediaBar|cid|ICID|icid|bdk|wtu_id_h|utm_placement|intcmp|_native_ads|traffic_source|entry|\.tsrc|autoplay|autostart|dc_data|influencer|pubdate|utm_hp_ref|redirect|service|refresh_ce|refresh_cens|xcmg|target_id|_amp)=[^&]*/g,"$2"],[/(\?|&)(?:amp)(?:&|$|=[^&]*)/g,"$1"]],Re=[[/(?:\/|\/\?|\?|&|\/\$0|#[\s\S]*)+$/g,""],[/(?:\/|\/\?|\?|&|\/\$0|#[\s\S]*)+$/g,""]],Bt=i((o,t)=>{for(let[e,n]of o)t=t.replace(e,n);return t},"replaceByRules"),Vt=i(o=>{let t=Bt(ve,o);return Bt(Re,t)},"normalizeUrl");var zt=i(o=>{try{let t=new URLSearchParams(o),e=t.get("ctx"),n=t.get("cmp");if(e!=null&&n!=null)return{ctx:e,cmp:n}}catch(t){}return null},"parseInfo"),jt=i(o=>{var t;return o.pathname!=="/signals/pub.js"?null:(t=zt(o.search))!=null?t:zt(o.hash.substring(1))},"parseLegacyPagetagUrl");var we=/^\/dvtag\/([^/]+)\/([^/]+)\/pub\.js$/,b=class{constructor(){d(this,"visitUuid",j());d(this,"tagInfo");d(this,"normalizedUrl")}getTagInfo(){var t;if(this.tagInfo==null){try{this.tagInfo=this.parseTagInfo()}catch(e){}(t=this.tagInfo)!=null||(this.tagInfo={ctx:"unknown",cmp:"unknown"})}return this.tagInfo}getVisitUuid(){return this.visitUuid}parseTagInfo(){let t=this.getCurrentScriptSrc();if(t==null)return null;let e=new URL(t),n=e.pathname,r=we.exec(n);if(r!=null){let[,s,a]=r;return{ctx:s,cmp:a}}return jt(e)}getCurrentScriptSrc(){var t,e,n;return(n=(e=(t=this.core.window.document.currentScript)==null?void 0:t.getAttribute)==null?void 0:e.call(t,"src"))!=null?n:null}getNormalizedPageUrl(){return this.normalizedUrl==null&&(this.normalizedUrl=Vt(this.core.window.location.href)),this.normalizedUrl}};i(b,"Context"),c([D],b.prototype,"getTagInfo",1),b=c([m],b);var $=class{getShortCommitId(){return"4cd5761"}getBuildTimestamp(){return 1682982011419}};i($,"DefinedVariables"),$=c([m],$);var M=class{getWindow(){return this.core.window}getDocument(){return this.getWindow().document}getUserAgent(){var t,e;return(e=(t=this.getWindow().navigator)==null?void 0:t.userAgent)!=null?e:""}getPageUrl(){var t,e;return(e=(t=this.getWindow().location)==null?void 0:t.href)!=null?e:""}getHostname(){return new URL(this.getPageUrl()).hostname}getNavigator(){return this.getWindow().navigator}getPerformance(){var t;return(t=this.getWindow().performance)!=null?t:{}}getPerformanceTimeMs(){var t,e,n;return Math.floor((n=(e=(t=this.getPerformance()).now)==null?void 0:e.call(t))!=null?n:null)}};i(M,"Environment"),M=c([m],M);var Ee=/^(\d+)x(\d+)$/,Qt=i(o=>o==="all"?[]:o.split(",").map(t=>{let e=t.match(Ee);return e==null?{label:t}:{width:parseInt(e[1],10),height:parseInt(e[2],10)}}),"stringToSlotSizes"),it=i(o=>o.length===0?"all":o.map(({width:t,height:e,label:n})=>n!=null?n:`${t}x${e}`).join(","),"slotSizesToString"),Kt=i(o=>o.length>0&&o.every(({label:n})=>n==null)?it(o):"","slotSizesToStringIfSpecific");var It="https://pub.doubleverify.com/dvtag/signals/",q=class{getBaseUrl(t){let e=this.core.get(b),{ctx:n,cmp:r}=e.getTagInfo(),s=e.getNormalizedPageUrl(),a=new URL(t,It);return a.searchParams.set("ctx",n),a.searchParams.set("cmp",r),a.searchParams.set("url",s),a}getUserTargetingUrl(t){let e=this.getBaseUrl("ids/pub.json");return t.includes("IDS")&&e.searchParams.set("ids","1"),e.href}getPageTargetingUrl(t){let e=this.getBaseUrl("bsc/pub.json");return t.includes("BSC")&&e.searchParams.set("bsc","1"),t.includes("ABS")&&e.searchParams.set("abs","1"),e.href}getSlotTargetingUrl(t,e){let n=this.getBaseUrl("vlp/pub.json");t.includes("VLP")&&n.searchParams.set("vlp","1"),t.includes("TVP")&&n.searchParams.set("tvp","1");let r=0;for(let{unitId:s,sizes:a}of e)n.searchParams.set(`slot-${r++}-${s}`,Kt(a));return n.href}};i(q,"SignalsUrlBuilder"),q=c([m],q);var $t="https://vtrk.doubleverify.com";var Ht=i(()=>Math.floor(1e12*Math.random()),"randomInt");var At="qt_loaded",Wt="pts_pid",Jt="pts_sid",H=class extends Error{constructor(e,n){super(n);this.code=e}};i(H,"QtError");var Yt=i((o,t)=>{var n,r;let e={};for(let[s,a]of t.entries()){let g=o[s];if(g!=null)for(let u of Q){let f=g[u];f==null||f.length<1||((r=e[n=a.uuid])!=null||(e[n]={}),e[a.uuid][u]=f[0])}}return e},"formatSlotTargetingForTracking");var Xt=i(({transferSize:o,decodedBodySize:t})=>o>0?"network":t>0?"cache":"unknown","getCacheStatus");var bt=i((o,t)=>o.reduce((e,n)=>{var s,a,g;let r=Number.parseInt((g=(a=(s=n[t])==null?void 0:s[0])==null?void 0:a.split)==null?void 0:g.call(a,"-")[0],10);return Number.isNaN(r)||(e+=r),e},0),"summarizeSlotTargeting");var K=i((o,t)=>o!=null&&t!=null?Math.round(t-o):void 0,"timeSpan");var st=class{constructor(t,e,n,r,s,a,g,u,f,y,h=1e3){d(this,"data");d(this,"start");d(this,"flushed",!1);d(this,"getPerformanceTimeMs");d(this,"sendPixel");d(this,"disabled");this.getPerformanceTimeMs=u,this.sendPixel=f,this.disabled=y,this.start=this.getPerformanceTimeMs(),this.data={["t"]:"event",["ec"]:"page",["ea"]:"unknown",["v"]:"1",["ctx"]:n,["cmp"]:r,["cid"]:e,["z"]:Ht(),["cd105"]:a,["cd160"]:j(),["cd161"]:s,["cd50"]:"upt",["cd51"]:t,["cd180"]:"no-fetches"},g!=null&&(this.data["cd52"]=g),setTimeout(()=>this.fireEvent(),h)}setEventAction(t){this.addData({["ea"]:t})}addRequestedSignals(t){let e=i(n=>n?"1":void 0,"toString");this.addData({["cm56"]:e(t.includes("IDS")),["cm57"]:e(t.includes("BSC")),["cm58"]:e(t.includes("ABS")),["cm59"]:e(t.includes("VLP")),["cm60"]:e(t.includes("TVP"))})}setAutoInsertionEnabled(){this.addData({["cd68"]:"1"})}addResultsData(t,e,n,r){t["IDS"]!=null&&this.addData({["cm170"]:t["IDS"][0],["cm61"]:t["IDS"][0]}),e["BSC"]!=null&&this.addData({["cd171"]:e["BSC"].join(","),["cm62"]:e["BSC"].length}),e["ABS"]!=null&&this.addData({["cm63"]:e["ABS"].length}),n.length!==0&&(this.addData({["cd175"]:JSON.stringify(Yt(n,r))}),n[0]["VLP"]!=null&&this.addData({["cm66"]:n.length,["cm64"]:bt(n,"VLP")}),n[0]["TVP"]!=null&&this.addData({["cm67"]:n.length,["cm65"]:bt(n,"TVP")}))}setRequestSuccess(){let t=this.getPerformanceTimeMs(),e;this.start!=null&&t!=null&&(e=Math.round(t-this.start)),this.addData({["cd53"]:"1",["cm54"]:e})}addFetchPerformanceData(t,e,n,r){var f,y;if(t==null){this.data["cd180"]==="no-fetches"&&(this.data["cd180"]=(r==null?void 0:r.getEntriesByName)==null?"no-api":"no-entry");return}n==="ids"&&this.addData({["cm187"]:Math.round(t.duration)}),n==="bsc"&&this.addData({["cm188"]:Math.round(t.duration)}),n==="vlp"&&this.addData({["cm189"]:Math.round(t.duration)});let s=this.getPerformanceTimeMs(),a=K(t.fetchStart,s),g=this.data["cm186"];if(a==null||g>a)return;let u=(f=t.secureConnectionStart)!=null?f:t.connectEnd;this.addData({["cd180"]:Xt(t),["cm180"]:K(t.fetchStart,t.responseEnd),["cm181"]:K(t.domainLookupStart,t.domainLookupEnd),["cm182"]:K(t.connectStart,u),["cm183"]:K(u,t.connectEnd),["cm184"]:K(t.requestStart,t.responseStart),["cm185"]:K(t.responseStart,t.responseEnd),["cm186"]:a,["cd191"]:(y=e==null?void 0:e.split("-"))==null?void 0:y[0]})}trackError(t){var e;this.addData({["ea"]:"error",["cd110"]:(e=t==null?void 0:t.message)!=null?e:"unknown error",["cd111"]:t instanceof H?t.code:void 0}),this.fireEvent()}addData(t){Object.assign(this.data,t)}fireEvent(){let t=Object.keys(this.data).filter(n=>this.data[n]!=null).map(n=>`${n}=${encodeURIComponent(this.data[n])}`),e=`${$t}?${t.join("&")}`;return!this.flushed&&!this.disabled&&this.sendPixel(e),this.flushed=!0,e}};i(st,"PendingEvent");var Ie=5,Ae=["ids","bsc","vlp"],k=class{constructor(){d(this,"plugins",{getLegacyType:[]});d(this,"eventCount",0)}trackInitialLoad(){var n;let t=this.createPendingEvent(void 0,!1);t.setEventAction("load-pq");let e=this.core.get(b).getCurrentScriptSrc();if(e!=null){let r=this.core.get(M).getPerformance(),s=(n=r.getEntriesByType)==null?void 0:n.call(r,"resource").find(a=>a.name===e);t.addFetchPerformanceData(s,null,"tag",r)}t.fireEvent()}createPendingEvent(t,e=!0){var nt;let n=this.core.get($),r=this.core.get(b),s=this.core.get(M),a=(nt=S(this.plugins.getLegacyType)[0])!=null?nt:"unknown",g=n.getShortCommitId(),u=r.getVisitUuid(),f=r.getNormalizedPageUrl(),{ctx:y,cmp:h}=r.getTagInfo(),T=s.getNavigator(),P=i(()=>s.getPerformanceTimeMs(),"getPerformanceTimeMs"),x=i(ot=>{try{typeof(T==null?void 0:T.sendBeacon)=="function"?T.sendBeacon(ot):new Image().src=ot}catch(E){}},"sendPixel"),V=this.eventCount>=Ie;return e&&this.eventCount++,new st(g,u,y,h,f,a,t,P,x,V)}findPerformanceEntries(){var e,n;let t=this.core.get(M).getPerformance();return(n=(e=t.getEntriesByType)==null?void 0:e.call(t,"resource").filter(r=>r.name.startsWith(It)).map(r=>{var a;return{type:(a=Ae.find(g=>r.name.includes(g)))!=null?a:"unknown",entry:r,performance:t}}))!=null?n:[]}};i(k,"LegacyTracking"),c([D],k.prototype,"trackInitialLoad",1),k=c([m],k);var Zt=i(o=>{var r,s,a;let t=(s=(r=o.adUnitPath)!=null?r:o.invCode)!=null?s:o.tagId,e=t,n=Qt((a=o.sizes)!=null?a:"all");return{unitId:t,elementId:e,sizes:n,uuid:j()}},"adUnitToSlot");var te=i((o,t)=>(t==null?void 0:t.structuredClone)!=null?t.structuredClone(o):JSON.parse(JSON.stringify(o)),"deepClone");var ee=i((o,t)=>{var n;let e=parseInt((n=o["IDS"])==null?void 0:n[0]);isNaN(e)||(t["IDS"]=e)},"setUserTargetingOnPts"),ne=i((o,t)=>{for(let e of ct)o[e]!=null&&(t[e]=o[e])},"setPageTargetingOnPts"),oe=i((o,t,e)=>{var s,a,g;let n=o.unitId,r=it(o.sizes);for(let u of Q)t[u]!=null&&((s=e[u])!=null||(e[u]={}),(g=(a=e[u])[n])!=null||(a[n]={}),e[u][n][r]=t[u][0])},"setSlotTargetingOnPts");var Dt=i(o=>Object.keys(o).filter(Rt).map(t=>t.toLowerCase()),"getGreenlightSignal");var W=class{autoInsertPageId(){let t=this.core.get(b);this.core.get(R).setGlobalTargeting({[Wt]:[t.getVisitUuid()]})}autoInsertGlobalTargeting(t){this.core.get(R).addGlobalTargeting(Z(z({},t),{[At]:Dt(t)}))}autoInsertSlotTargeting(t,e){this.core.get(R).addSlotTargeting(t.elementId,Z(z({},e),{[At]:Dt(e),[Jt]:[t.uuid]}))}};i(W,"LegacyModeAutoInsertion"),W=c([m],W);var G=class{constructor(){d(this,"cache",{})}performFetchJson(t){return p(this,null,function*(){let e=yield this.core.window.fetch(t);return{json:yield e.json(),headers:e.headers}})}fetchJson(t){return p(this,null,function*(){let e=this.cache[t];return e==null&&(e=this.performFetchJson(t).then(n=>n.json),this.cache[t]=e),e})}fetchJsonWithHeaders(t){return p(this,null,function*(){let e=this.cache[t];if(e!=null)return{data:yield e};let n=this.performFetchJson(t);this.cache[t]=n.then(a=>a.json);let{json:r,headers:s}=yield n;return{data:r,headers:s}})}};i(G,"Fetch"),G=c([m],G);var be="cf-ray",J=class{reportPerformance(t,e,n,r){var s;try{let a=this.core.get(M).getPerformance(),g=(s=a.getEntriesByType)==null?void 0:s.call(a,"resource").find(u=>u.name===t);r.addFetchPerformanceData(g,e==null?void 0:e.get(be),n,a)}catch(a){}}getUserTargeting(t,e){return p(this,null,function*(){if(!t.some(qt))return{};let n=this.core.get(q).getUserTargetingUrl(t);try{let{data:r,headers:s}=yield this.core.get(G).fetchJsonWithHeaders(n);return this.reportPerformance(n,s,"ids",e),r}catch(r){return e.trackError(r),{}}})}getPageTargeting(t,e){return p(this,null,function*(){if(!t.some(Gt))return{};let n=this.core.get(q).getPageTargetingUrl(t);try{let{data:r,headers:s}=yield this.core.get(G).fetchJsonWithHeaders(n);return this.reportPerformance(n,s,"bsc",e),r}catch(r){return e.trackError(r),{}}})}getSlotTargeting(t,e,n){return p(this,null,function*(){if(!t.some(et)||e.length===0)return new Array(e.length).fill({});let r=this.core.get(q).getSlotTargetingUrl(t,e);try{let{data:s,headers:a}=yield this.core.get(G).fetchJsonWithHeaders(r);return this.reportPerformance(r,a,"vlp",n),s.length!==e.length?new Array(e.length).fill({}):s}catch(s){return n.trackError(s),new Array(e.length).fill({})}})}getTargeting(t,e,n){return p(this,null,function*(){let[r,s,a]=yield Promise.all([this.getUserTargeting(t,n),this.getPageTargeting(t,n),this.getSlotTargeting(t,e,n)]);return{userTargeting:r,pageTargeting:s,slotTargeting:a}})}};i(J,"LegacyModeFetchTargeting"),J=c([m],J);var De={SignalsIds:"IDS",SignalsBsc:"BSC",SignalsAbs:"ABS",SignalsVlp:"VLP",SignalsTvp:"TVP"},xe="SignalsAutoInsertion",Y=class{constructor(){d(this,"validConfigFound");d(this,"enabledSignals");d(this,"autoInsertionEnabled")}isValidConfigFound(){return this.initialize(),this.validConfigFound}isSignalEnabled(t){return this.initialize(),t!=null&&this.enabledSignals.includes(t)}isAutoInsertionEnabled(){return this.initialize(),this.autoInsertionEnabled}initialize(){if(this.validConfigFound!=null)return;let t;try{t=this.getEntryModules()}catch(e){this.validConfigFound=!0,this.enabledSignals=vt,this.autoInsertionEnabled=!0;return}if(t==null){this.validConfigFound=!1,this.enabledSignals=[],this.autoInsertionEnabled=!1;return}this.validConfigFound=!0,this.enabledSignals=t.map(e=>De[e]).filter(e=>e!=null),this.autoInsertionEnabled=t.includes(xe)}getEntryModules(){let{cmp:t}=this.core.get(b).getTagInfo(),e=btoa(t),{modules:n,configs:r}=l,s=r[e];return s==null?null:s.map(a=>n[a])}};i(Y,"TagConfig"),Y=c([m],Y);var re=i((o,t)=>{var s,a,g;let e=[],n=[],r=[];if(t.VLP==null)return{newSlots:o,existingSlots:n,existingTargeting:r};for(let u of o){let{unitId:f,sizes:y}=u,h=it(y),T=(s=t.VLP[f])==null?void 0:s[h];if(T==null){e.push(u);continue}n.push(u);let P=(g=(a=t.TVP)==null?void 0:a[f])==null?void 0:g[h],x={};T!=null&&(x.VLP=[T]),P!=null&&(x.TVP=[P]),r.push(x)}return{newSlots:e,existingSlots:n,existingTargeting:r}},"processNewSlots");var B=class{performFetches(t,e,n,r,s){return p(this,null,function*(){let a=this.core.get(J),g=this.core.get(Y),u=this.core.get(W),f=this.core.get(N).getPts();if(s.addRequestedSignals(wt(t)),!g.isValidConfigFound())throw new H("404","Config not found!");let y=wt(t).filter(E=>g.isSignalEnabled(E)).filter(E=>et(E)||f[E]==null),{newSlots:h,existingSlots:T,existingTargeting:P}=r?re(e,f):{newSlots:e,existingSlots:[],existingTargeting:[]};e=[...h,...T],s.setEventAction("request-timeout");let{userTargeting:x,pageTargeting:V,slotTargeting:nt}=yield a.getTargeting(y,h,s);s.setEventAction("unknown");let ot=[...nt,...P];ee(x,f),ne(V,f);for(let E=0;E<e.length;E++)oe(e[E],ot[E],f);if(n&&g.isAutoInsertionEnabled()){s.setAutoInsertionEnabled(),u.autoInsertPageId(),u.autoInsertGlobalTargeting(x),u.autoInsertGlobalTargeting(V);for(let E=0;E<e.length;E++)u.autoInsertSlotTargeting(e[E],ot[E])}return s.addResultsData(x,V,nt,h),te(f,this.core.window)})}};i(B,"LegacyPerformFetches"),B=c([m],B);var X=class{initialize(){this.core.get(N).setApi({loadSignals:this.loadSignals.bind(this),loadSignalsForSlots:this.loadSignalsForSlots.bind(this),getTargeting:this.getTargeting.bind(this)})}getLegacyType(){return"mode"}loadSignals(t,e){return p(this,null,function*(){let n=this.core.get(k),r=this.core.get(B),s=this.core.get(R),a=n.createPendingEvent("loadSignals"),g=Array.isArray(t)?t:t.signals;a.setEventAction("slot-timeout");let u=g.some(et)?yield s.getSlots():[];a.setEventAction("unknown");let f=!0,y=!1;try{yield r.performFetches(g,u,f,y,a),a.setRequestSuccess(),a.setEventAction("load-signals"),F(()=>e==null?void 0:e())}catch(h){F(()=>e==null?void 0:e(h)),a.trackError(h)}finally{a.fireEvent()}})}loadSignalsForSlots(t,e,n){return p(this,null,function*(){let r=this.core.get(k),s=this.core.get(B),a=r.createPendingEvent("loadSignalsForSlots"),g=Array.isArray(e)?e:Q,u=t.map(h=>lt(h)),f=!0,y=!0;n=typeof e=="function"?e:n;try{yield s.performFetches(g,u,f,y,a),a.setRequestSuccess(),a.setEventAction("load-signals-slots"),F(()=>n==null?void 0:n())}catch(h){F(()=>n==null?void 0:n(h)),a.trackError(h)}finally{a.fireEvent()}})}getTargeting(t,e){return p(this,null,function*(){var h;let n=this.core.get(k),r=this.core.get(B),s=n.createPendingEvent("getTargeting"),{signals:a,adUnits:g}=t,u=(h=g==null?void 0:g.map(T=>Zt(T)))!=null?h:[],f=!1,y=!1;try{let T=yield r.performFetches(a!=null?a:[],u,f,y,s);s.setRequestSuccess(),s.setEventAction("load-signals"),F(()=>e==null?void 0:e(void 0,T))}catch(T){F(()=>e==null?void 0:e(T)),s.trackError(T)}finally{s.fireEvent()}})}};i(X,"LegacyMode"),c([D],X.prototype,"initialize",1),c([I(k,"getLegacyType")],X.prototype,"getLegacyType",1),X=c([m],X);var _e=[L],ie;if(((ie=window.dvtag)==null?void 0:ie._core)==null)try{new tt([...pt,..._e],window)}catch(o){}})();
